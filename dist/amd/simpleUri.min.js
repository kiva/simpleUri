/**
* simpleUri v0.2.0
* Lightweight uri parsing and url manipulation library
*
* Copyright (c) 2013 Kiva Microfunds
* Licensed under the MIT license.
* https://github.com/kiva/simpleUri/blob/master/license.txt
*
* Inspired by (and snagged some code from) the following:
* - JQuery URL Parser plugin by Mark Perkins, https://github.com/allmarkedup/jQuery-URL-Parser
* - Steven Levithan's uri parser http://blog.stevenlevithan.com/archives/parseuri
* - URI.js, https://github.com/medialize/URI.js
* - http://stackoverflow.com/a/3855394/500270
*/
define(function(r){function e(r,a){var o;return 1===arguments.length&&r===!0&&(a=!0,r=void 0),r=r||window.location.href,o=e.parseUri(r,a),o._getParam=function(r,e){return void 0===e?o._param[r]:o._param[r][e]},o._setParam=function(r,a){var n,s,i=o._param[r],h="query"==r?"?":"#";return n=t.extend({},i,a),s=h+t.param(n),decodeURI(window.location.href)==o.href?e(s).reload():(s="query"==r?s+"#"+o.hash:"?"+o.query+s,o=e(this.protocol+"://"+o.host+o.path+s),n)},o._paramProcess=function(r,e){return e&&"string"!=typeof e?this._setParam(r,e):this._getParam(r,e)},o.param=function(r){if(r&&"string"!=typeof r&&!t.isArray(r))throw".param() can only be used as a getter.  Try .queryParam() or .hashParam()";return"string"==typeof r?o.hashParam(r)||o.queryParam(r):t.extend({},o.queryParam(r),o.hashParam(r))},o.hashParam=function(r){return o._paramProcess("hash",r)},o.queryParam=function(r){return o._paramProcess("query",r)},o.open=function(r,e){return window.open(o.href,r,e)},o.load=function(r){o.href===window.location.href?o.reload(r):window.location.assign(o.href)},o.reload=function(r){window.location.reload(r)},o.replace=function(){window.location.replace(o.href)},o.segment=function(r){return void 0===r?o._seg.path:(r=0>r?o._seg.path.length+r:r-1,o._seg.path[r])},o}var t=r("jquery");return e.parseString=function(r){var e,t,a,o=r.split(/&|;/),n={};if(!r)return n;for(e=0;o.length>e;++e)t=o[e].split("="),a=t.length,a>=2?n[t[0]]=decodeURIComponent(t[a-1].replace(/\+/g," ")):1==a&&(n[t[0]]="");return n},e.parseUri=function(r,t){t=void 0===t?this.config.strictMode:t,r=decodeURI(r);var a,o=t?"strict":"loose",n=this.config.parser[o].exec(r),s=this.config.uriParts,i={_param:{},_seg:{}};for(a=0;s.length>a;a++)i[s[a]]=n[a]||"";return i._param.query=this.parseString(i.query),i._param.hash=this.parseString(i.hash),i._seg.path=i.path.replace(/^\/+|\/+$/g,"").split("/"),e.base=e.host?(i.protocol?i.protocol+"://"+i.host:i.host)+(i.port?":"+i.port:""):"",i},e.config={uriParts:["href","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","hash"],strictMode:!1,parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},e});